<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>Dropdown - TestCases</title>
	<link rel="stylesheet" type="text/css" href="../php/packer.php?type=css&get=dropdown">
	<link href="../libs/css/qunit.css" rel="stylesheet">
</head>
<body>

<!-- #body -->
	<h1>Chico-UI: Dropdown testcases</h1>
    <hr />
    <div class="box">
		<div id="drop1" class="testDropdown">
			<span>Primary Skin</span>
			<ul>
				<li><a href="http://www.mercadolibre.com">MercadoLibre</a></li>
				<li><a href="http://www.mercadopago.com">MercadoPago</a></li>
				<li><a href="http://www.mercadoshops.com">MercadoShops</a></li>
				<li><a href="http://www.mercadoclics.com">MercadoClics</a></li>

			</ul>
		</div>
	</div>
	<div class="box">
		<div id="drop2" class="testDropdown secondary">
			<span>Secondary Skin</span>
			<ul>
				<li><a href="http://www.mercadolibre.com">MercadoLibre</a></li>
				<li><a href="http://www.mercadopago.com">MercadoPago</a></li>
				<li><a href="http://www.mercadoshops.com">MercadoShops</a></li>
				<li><a href="http://www.mercadoclics.com">MercadoClics</a></li>

			</ul>
		</div>
	</div>
	<div class="box">
		<div id="drop3" class="testDropdown">
			<span>Non-relative container</span>
			<ul>
				<li><a href="http://www.mercadolibre.com">MercadoLibre</a></li>
				<li><a href="http://www.mercadopago.com">MercadoPago</a></li>
				<li><a href="http://www.mercadoshops.com">MercadoShops</a></li>
				<li><a href="http://www.mercadoclics.com">MercadoClics</a></li>

			</ul>
		</div>
	</div>
	
	<div class="box" style="position:relative;">
		<div id="drop4" class="testDropdown">
			<span>First relative container</span>
			<ul>
				<li><a href="http://www.mercadolibre.com">MercadoLibre</a></li>
				<li><a href="http://www.mercadopago.com">MercadoPago</a></li>
				<li><a href="http://www.mercadoshops.com">MercadoShops</a></li>
				<li><a href="http://www.mercadoclics.com">MercadoClics</a></li>

			</ul>
		</div>
	</div>
	
	<div class="box" style="position:relative;">
		<div>
			<div id="drop5" class="testDropdown">
				<span>Any relative container</span>
				<ul>
					<li><a href="http://www.mercadolibre.com">MercadoLibre</a></li>
					<li><a href="http://www.mercadopago.com">MercadoPago</a></li>
					<li><a href="http://www.mercadoshops.com">MercadoShops</a></li>
					<li><a href="http://www.mercadoclics.com">MercadoClics</a></li>

				</ul>
			</div>
		</div>
	</div>
	
	<div class="box" style="position:relative;">
		<div style="position:relative;">
			<div id="drop6" class="testDropdown">
				<span>Multiple (2) containers relative</span>
				<ul>
					<li><a href="http://www.mercadolibre.com">MercadoLibre</a></li>
					<li><a href="http://www.mercadopago.com">MercadoPago</a></li>
					<li><a href="http://www.mercadoshops.com">MercadoShops</a></li>
					<li><a href="http://www.mercadoclics.com">MercadoClics</a></li>

				</ul>
			</div>
		</div>
	</div>
	
	<div class="box" style="position:relative;">
		<div style="position:relative;">
			<div style="position:relative;">
				<div id="drop7" class="testDropdown">
					<span>Multiple (3+) containers relative</span>
					<ul>
						<li><a href="http://www.mercadolibre.com">MercadoLibre</a></li>
						<li><a href="http://www.mercadopago.com">MercadoPago</a></li>
						<li><a href="http://www.mercadoshops.com">MercadoShops</a></li>
						<li><a href="http://www.mercadoclics.com">MercadoClics</a></li>

					</ul>
				</div>
			</div>
		</div>
	</div>
	
	<div class="box" style="overflow:hidden;">
		<div id="drop8" class="testDropdown" style="float:right;">
			<span>Right position</span>
			<ul>
				<li><a href="http://www.mercadolibre.com">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas id dui risus.</a></li>
				<li><a href="http://www.mercadopago.com">MercadoPago</a></li>
				<li><a href="http://www.mercadoshops.com">MercadoShops</a></li>
				<li><a href="http://www.mercadoclics.com">MercadoClics</a></li>
		
			</ul>
		</div>
	</div>
	
	<div class="box" style="overflow:hidden;">
		<div id="drop9" class="testDropdown secondary" style="float:right;">
			<span>Right position</span>
			<ul>
				<li><a href="http://www.mercadolibre.com">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas id dui risus.</a></li>
				<li><a href="http://www.mercadopago.com">MercadoPago</a></li>
				<li><a href="http://www.mercadoshops.com">MercadoShops</a></li>
				<li><a href="http://www.mercadoclics.com">MercadoClics</a></li>
		
			</ul>
		</div>
	</div>
	
	<div class="box">
		<div id="drop10" class="ch-primary">
			<span>Callbacks</span>
			<ul>
				<li><a href="http://www.mercadolibre.com">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas id dui risus.</a></li>
				<li><a href="http://www.mercadopago.com">MercadoPago</a></li>
				<li><a href="http://www.mercadoshops.com">MercadoShops</a></li>
				<li><a href="http://www.mercadoclics.com">MercadoClics</a></li>
		
			</ul>
		</div>
	</div>
	
<!-- #body -->
	<hr style="clear:both;">

	<h1 id="qunit-header">QUnit Test Suite</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>
	<div id="qunit-fixture">test markup</div>

	<script src="../libs/js/jquery.js"></script>
	<script src="../libs/js/qunit.js"></script>
	<script src="../php/packer.php?get=dropdown&debug=true"></script>
	<script src="functions.js"></script>
	
<!-- #script -->
	<script>

		var testDropdown = $('.testDropdown').dropdown();
		var testDropdown2 = $('#drop10').dropdown({
			onShow: function(){
				$("body").addClass("onShow");
	        },

	        onHide: function(){
				$("body").addClass("onHide");
	        }
		});
		
		$.fx.off = true;

		/**
		 * 	Test Cases
		 */
		
		
		// Dropdown 1
		module("Layer instance object");
		
        test("Dropdown public properties", function(){

            expect( 3 );

       		ok( testDropdown[0].uid >= 0 , "Expected to find a \"uid\" attribute on the layer instance");
       		
    		ok( testDropdown[0].type == "dropdown" , "Expected to find \"dropdown\" as value of type attribute");
    		
    		ok( ch.utils.hasOwn(testDropdown[0], "element"), "Expected to find an \"element\" property" );

        });
        
        test("Dropdown public methods", function(){

            expect( 3 );
    		
    		ok( ch.utils.hasOwn(testDropdown[0], "position"), "Expected to find a \"position\" method" );
    		
    		ok( ch.utils.hasOwn(testDropdown[0], "show"), "Expected to find a \"show\" method" );
    		
    		ok( ch.utils.hasOwn(testDropdown[0], "hide"), "Expected to find a \"hide\" method" );

        });
        
        test("Dropdown chain methods", function(){
            
            expect ( 3 );
            
            var testDropdownOriginal = testDropdown[0];
            
            var chainShow = testDropdown[0].show();
            
            var chainHide = testDropdown[0].hide();

            var chained = testDropdown[0].show().hide();
             
            ok ( chainShow === testDropdownOriginal, "Expected to return original instance object on show() method call");
            
            ok ( chainHide === testDropdownOriginal, "Expected to return original instance object on hide() method call");

            ok ( chained === testDropdownOriginal, "Expected to return original instance object on .show().hide() methods chained call");
            
        });

		module('Primary dropdown layout and interaction');

		var $trigger = $('#drop1').children(':first');
		var $content = $('#drop1').next();

		test('Check for the right visual classes on primary skin', function() {
			
			expect ( 4 );
			
			hasClass('.testDropdown', 'ch-dropdown');
			hasClass($trigger, 'ch-dropdown-trigger');
			hasClass($content, 'ch-dropdown-content');
			hasClass($trigger.find('span'), 'ico');
			
		});
		
		test('Opens dropdown menu', function() {
			
			expect ( 3 );
			
			isNotVisible($content);
			
			$trigger.click();
			
			isVisible($content);
			hasClass($trigger, 'ch-dropdown-trigger-on');
			
		});
		
		test('Closes dropdown menu, clicking on body', function() {
			
			expect ( 2 );
			
			$('body').click();
			
			isNotVisible($content);
			hasNotClass($trigger, 'ch-dropdown-trigger-on');
			
		});
		
		test('Closes dropdown menu, clicking on component trigger', function() {
			
			expect ( 2 );
			
			$trigger.click();
			$trigger.click();
			
			isNotVisible($content);
			hasNotClass($trigger, 'ch-dropdown-trigger-on');
			
		});
		
		test('Click inside content', function() {
			
			expect ( 2 );
			
			$trigger.click();
			$content.click();
			
			isVisible($content);
			hasClass($trigger, 'ch-dropdown-trigger-on');
			
			$trigger.click();
			
		});
		
		test('Click on content link', function() {
			
			expect ( 2 );
			
			$trigger.click();
			$content.find('a').click();
			
			isNotVisible($content);
			hasNotClass($trigger, 'ch-dropdown-trigger-on');
			
		});
		
		
		// Dropdown 2
		
		module('Secondary dropdown layout and interaction');
		
		var $trigger2 = $('#drop2').children(':first');
		var $content2 = $('#drop2').next();
		
		test('Check for the right visual classes on secondary skin', function() {
			
			expect ( 5 );
			
			hasClass('#drop2', 'ch-dropdown');
			hasClass('#drop2', 'secondary');
			hasClass($trigger2, 'ch-dropdown-trigger');
			hasClass($content2, 'ch-dropdown-content');
			hasClass($trigger2.find('span'), 'ico');
			
		});
		
		test('Opens dropdown menu', function() {
			
			expect ( 4 );
			
			isNotVisible($content2);
			
			$trigger2.click();
			
			isVisible($content2);
			hasClass($trigger2, 'ch-dropdown-trigger-on');
			hasClass('#drop2', 'ch-dropdown-on');
		});
		
		test('Closes dropdown menu, clicking on body', function() {
			
			expect ( 3 );
			
			$('body').click();
			
			isNotVisible($content2);
			hasNotClass($trigger2, 'ch-dropdown-on');
			hasNotClass($('#drop2'), 'ch-dropdown-on');
			
		});
		
		test('Closes dropdown menu, clicking on component trigger', function() {
			
			expect ( 3 );
			
			$trigger2.click();
			$trigger2.click();
			
			isNotVisible($content2);
			hasNotClass($trigger, 'ch-dropdown-trigger-on');
			hasNotClass($('#drop2'), 'ch-dropdown-on');
			
		});
		
		
		// Dropdown 3
		
		module('Dropdown behavior with "relative" positioned containers');
		
		test('Position of content with not relative container', function() {
			
			expect ( 2 );
			
			var $trigger3 = $('#drop3').children(':first');
			var $content3 = $('#drop3').next();
			
			$trigger3.click();
			
			equal( $content3.offset().left, $trigger3.offset().left, "Expected to find content left position = trigger left position");
       		equal( $content3.offset().top, $trigger3.offset().top + $trigger3.outerHeight() - 1, "Expected to find content top position = trigger bottom position (except border-bottom)"); // 1 = Offset
       	});
       	
       	
       	// Dropdown 4
       	
       	test('Position of content with first relative container', function() {
			
			expect ( 2 );
			
			var $trigger4 = $('#drop4').children(':first');
			var $content4 = $('#drop4').next();
			
			$trigger4.click();
			
			equal( $content4.position().left, $trigger4.position().left + 10, "Expected to find content left position = trigger left position"); // 10 = padding
       		equal( $content4.position().top, $trigger4.position().top + 10 + $trigger4.outerHeight() - 1, "Expected to find content top position = trigger bottom position (except border-bottom)"); // 10 = padding | 1 = offset
       	});
       	
       	
       	// Dropdown 5
       	
       	test('Position of content with second relative container', function() {
			
			expect ( 2 );
			
			var $trigger5 = $('#drop5').children(':first');
			var $content5 = $('#drop5').next();
			
			$trigger5.click();
			
			equal( $content5.position().left, $trigger5.position().left + 10, "Expected to find content left position = trigger left position"); // 10 = padding
       		equal( $content5.position().top, $trigger5.position().top + 10 + $trigger5.outerHeight() - 1, "Expected to find content top position = trigger bottom position (except border-bottom)"); // 10 = padding | 1 = border
       	});
       	
       	
       	// Dropdown 6
       	
       	test('Position of content with 2 relative containers', function() {
			
			expect ( 2 );
			
			var $trigger6 = $('#drop6').children(':first');
			var $content6 = $('#drop6').next();
			
			$trigger6.click();
			
			equal( $content6.position().left, $trigger6.position().left, "Expected to find content left position = trigger left position");
       		equal( $content6.position().top, $trigger6.position().top + $trigger6.outerHeight() - 2, "Expected to find content top position = trigger bottom position (except border-bottom)"); // 2 = borders
       	});
       	
       	
       	// Dropdown 7
       	
       	test('Position of content with 3 relative containers', function() {
			
			expect ( 2 );
			
			var $trigger7 = $('#drop7').children(':first');
			var $content7 = $('#drop7').next();
			
			$trigger7.click();
			
			equal( $content7.position().left, $trigger7.position().left, "Expected to find content left position = trigger left position");
       		equal( $content7.position().top, $trigger7.position().top + $trigger7.outerHeight() - 2, "Expected to find content top position = trigger bottom position (except border-bottom)"); // 2 = borders
       	});
       	
       	
       	module('Dropdown behavior with spaceless viewport');
       	
       	// Dropdown 8
       	
       	test('Position of content dropped to left on primary dropdown', function() {
			
			expect ( 2 );
			
			var $trigger8 = $('#drop8').children(':first');
			var $content8 = $('#drop8').next();
			
			$trigger8.click();
			
			ok( $content8.offset().left < $trigger8.offset().left, "Expected to find content left position < trigger left position");
       		equal( $content8.offset().top, $trigger8.offset().top + $trigger8.outerHeight() - 1, "Expected to find content top position = trigger bottom position (except border-bottom)"); // 1 = Offset
       		
       		$trigger8.click();
       	});
       	
       	
       	// Dropdown 9
       	
       	test('Position of content dropped to left on secondary dropdown', function() {
			
			expect ( 2 );
			
			var $trigger9 = $('#drop9').children(':first');
			var $content9 = $('#drop9').next();
			
			$trigger9.click();
			
			equal( $content9.offset().left + $content9.outerWidth(), $trigger9.offset().left + $trigger9.outerWidth(), "Expected to find content right position = trigger right position");
       		equal( $content9.offset().top, $trigger9.offset().top + $trigger9.outerHeight() - 1, "Expected to find content top position = trigger bottom position (except border-bottom)"); // 1 = Offset
       		
       		$trigger9.click();
       	});
       	
       	
       	// Dropdown 10
       	module("Dropdown callbacks");   	
		
		test('Dropdown callback on show', function() {
			
			expect ( 1 );
			
			testDropdown2.show();
			
			hasClass("body", "onShow");
			
			$("body").removeClass("onShow");

       	});
       	
       	test('Dropdown callback on hide', function() {
			
			expect ( 1 );
			
			testDropdown2.hide();
			
			hasClass("body", "onHide");
			
			$("body").removeClass("onHide");

       	});

	</script>

</body>
</html>
